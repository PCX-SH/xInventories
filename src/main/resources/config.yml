#  __  ___                      _             _
#  \ \/ (_)_ ____   _____ _ __ | |_ ___  _ __(_) ___  ___
#   \  /| | '_ \ \ / / _ \ '_ \| __/ _ \| '__| |/ _ \/ __|
#   /  \| | | | \ V /  __/ | | | || (_) | |  | |  __/\__ \
#  /_/\_\_|_| |_|\_/ \___|_| |_|\__\___/|_|  |_|\___||___/
#
# xInventories Configuration
# Documentation: https://pcx.gg/xinventories

# Storage backend configuration
storage:
  # Type: yaml, sqlite, mysql
  type: yaml

  # SQLite settings (only if type: sqlite)
  sqlite:
    file: "data/inventories.db"

  # MySQL settings (only if type: mysql)
  mysql:
    host: "localhost"
    port: 3306
    database: "xinventories"
    username: "root"
    password: ""
    # HikariCP pool settings
    pool:
      maximum-pool-size: 10
      minimum-idle: 2
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

# Cache configuration
cache:
  enabled: true
  # Maximum entries in cache
  max-size: 1000
  # Time-to-live in minutes (0 = never expire)
  ttl-minutes: 30
  # Write-behind delay in seconds (batch writes)
  write-behind-seconds: 5

# Feature toggles
features:
  # Separate inventories per gamemode within groups
  separate-gamemode-inventories: true
  # Save inventory when changing worlds
  save-on-world-change: true
  # Save inventory when changing gamemodes
  save-on-gamemode-change: true
  # Use async saving (recommended)
  async-saving: true
  # Clear inventory on death (per-group override available)
  clear-on-death: false
  # Notify admins of critical errors
  admin-notifications: true

# ============================================================
# Player State Defaults (PWI-style)
# ============================================================
# Global defaults for what player data to save/restore.
# These can be overridden per-group in groups.yml.
player:
  # Core player state
  save-health: true
  save-hunger: true
  save-saturation: true
  save-exhaustion: true
  save-experience: true
  save-potion-effects: true
  save-ender-chest: true
  save-inventory: true
  save-gamemode: false

  # Flight state
  save-flying: true
  save-allow-flight: true

  # Environmental state
  save-fall-distance: true
  save-fire-ticks: true
  save-maximum-air: true
  save-remaining-air: true

  # Display (opt-in - may conflict with other plugins)
  save-display-name: false

  # Advanced (opt-in - can be performance intensive)
  save-statistics: false
  save-advancements: false
  save-recipes: false

# Backup configuration
backup:
  # Enable automatic backups
  auto-backup: true
  # Interval in hours
  interval-hours: 24
  # Maximum backups to keep (0 = unlimited)
  max-backups: 7
  # Compress backups
  compression: true
  # Backup directory
  directory: "backups"

# Performance tuning
performance:
  # Batch size for bulk operations
  batch-size: 100
  # Async thread pool size
  thread-pool-size: 4
  # Save delay on world change (ticks, 0 = immediate)
  save-delay-ticks: 1

# ============================================================
# Inventory Versioning
# ============================================================
# Track inventory changes over time for rollback capability.
versioning:
  enabled: true
  # Maximum versions kept per player per group
  max-versions-per-player: 10
  # Minimum seconds between versions (prevent spam)
  min-interval-seconds: 300
  # Auto-delete versions older than this (days)
  retention-days: 7
  # When to create versions
  trigger-on:
    world-change: true
    disconnect: true
    manual: true

# ============================================================
# Death Recovery
# ============================================================
# Preserve inventory on death for recovery.
death-recovery:
  enabled: true
  # Maximum deaths stored per player
  max-deaths-per-player: 5
  # Auto-delete deaths older than this (days)
  retention-days: 3
  # Store additional death context
  store-location: true
  store-death-cause: true
  store-killer: true

# ============================================================
# Inventory Locking
# ============================================================
# Temporarily freeze player inventories.
locking:
  enabled: true
  # Message shown when locked player tries to modify inventory
  default-message: "<red>Your inventory is currently locked."
  # Allow admins with xinventories.lock.bypass to modify locked inventories
  allow-admin-bypass: true

# ============================================================
# Shared Slots
# ============================================================
# Slots that persist across all groups.
shared-slots:
  enabled: true
  slots: []
  # Example shared slot configuration:
  # slots:
  #   - slot: 8                    # Hotbar slot 9 (0-indexed)
  #     mode: PRESERVE             # PRESERVE, LOCK, SYNC
  #     item:                      # Optional: enforce specific item
  #       type: COMPASS
  #       display-name: "<gold>Server Menu"
  #   - slots: [36, 37, 38, 39]    # All armor slots
  #     mode: PRESERVE

# ============================================================
# Economy Integration
# ============================================================
# Separate Vault economy balances per inventory group.
economy:
  enabled: true
  # Economy provider: VAULT
  provider: VAULT
  # Whether to separate balances by group
  separate-by-group: true

# ============================================================
# Cross-Server Synchronization (Network Sync)
# ============================================================
# Enable this for multi-server networks using BungeeCord/Velocity.
# Requires Redis for real-time synchronization.
sync:
  # Enable cross-server sync
  enabled: false

  # Sync mode: REDIS (recommended), PLUGIN_MESSAGING, MYSQL_NOTIFY
  mode: REDIS

  # Unique identifier for this server (must be different on each server)
  server-id: "server-1"

  # Redis connection settings
  redis:
    host: "localhost"
    port: 6379
    password: ""
    # Redis pub/sub channel for sync messages
    channel: "xinventories:sync"
    # Connection timeout in milliseconds
    timeout: 5000

  # Conflict resolution when the same player is modified on multiple servers
  conflicts:
    # Strategy: LAST_WRITE_WINS, MERGE, PROMPT_ADMIN
    strategy: LAST_WRITE_WINS

    # Merge rules (only used when strategy is MERGE)
    merge-rules:
      # How to merge inventory: NEWER, OLDER, CURRENT_SERVER
      inventory: NEWER
      # How to merge experience: HIGHER, LOWER, NEWER, OLDER
      experience: HIGHER
      # How to merge health: HIGHER, LOWER, CURRENT_SERVER, NEWER
      health: CURRENT_SERVER
      # How to merge potion effects: UNION, INTERSECTION, NEWER
      potion-effects: UNION

  # Lock transfer for seamless server switches
  transfer-lock:
    # Enable lock transfer during server transfers
    enabled: true
    # Timeout in seconds to wait for lock during transfer
    timeout-seconds: 10

  # Heartbeat for server health monitoring
  heartbeat:
    # Interval in seconds between heartbeats
    interval-seconds: 30
    # Timeout in seconds before considering a server dead
    timeout-seconds: 90

# ============================================================
# Audit Logging
# ============================================================
# Track all inventory modifications for security and debugging.
audit:
  # Enable audit logging
  enabled: true
  # Number of days to keep audit entries
  retention-days: 30
  # Log when admins view player inventories (can generate many entries)
  log-views: false
  # Log automatic inventory saves
  log-saves: true

# ============================================================
# Anti-Dupe Detection
# ============================================================
# Detect potential item duplication exploits.
anti-dupe:
  # Enable anti-dupe detection
  enabled: true
  # Sensitivity level: LOW, MEDIUM, HIGH
  # LOW: Only obvious dupes, minimal false positives
  # MEDIUM: Balanced detection (recommended)
  # HIGH: Aggressive detection, may have false positives
  sensitivity: MEDIUM
  # Minimum milliseconds between group switches (faster is suspicious)
  min-switch-interval-ms: 500
  # Freeze player inventory when high-severity dupe is detected
  freeze-on-detection: false
  # Notify online admins when dupe is detected
  notify-admins: true
  # Log all detections to console
  log-detections: true

# ============================================================
# Startup Branding
# ============================================================
# Configure the startup banner and statistics display.
startup:
  # Show the ASCII art banner on startup
  show-banner: true
  # Show plugin statistics (storage type, groups, sync status) on startup
  show-stats: true

# Enable bStats metrics collection (https://bstats.org/plugin/bukkit/xInventories)
# This helps us understand how the plugin is used and improve it.
# All data is anonymous and no personal information is collected.
metrics: true

# Debug mode (verbose logging)
debug: false

# ============================================================
# Internal Configuration
# ============================================================
# DO NOT MODIFY THIS VALUE - it is used for automatic config migration
config-version: 1
